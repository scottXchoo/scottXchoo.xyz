---
emoji: 🤖
title: 🤖 CNN 개념 이해하기
date: '2023-10-10 20:00:00'
author: 추교현
tags: DL CNN
categories: 🤖ML/DL
---

CNN 개념에 대해서 정리하고자 합니다.@

---

## CNN의 개요

CNN(Convolutional Neural Networks; 합성곱 신경망)은 인간 뇌의 시각 피질과 유사한 구조를 가진 **합성곱층**을 사용하여 특징을 추출하는 신경망입니다.

CNN은 대부분의 경우 합성곱층과 함께 **풀링층**이 사용됩니다. 합성곱층에서 얻은 정보를 축약하여 풀링층에서 최종적으로 이미지의 분류 등을 실시하게 됩니다.

**합성곱층**은 전결합층(Fully Connected Layer)처럼 특징을 추출하는 계층이지만 전결합층과 달리 2차원 그대로의 이미지 데이터를 처리하여 특징을 추출할 수 있기 때문에 선이나 모서리와 같은 **2차원적 특징**을 추출하는 데 뛰어납니다.

## 합성곱층 (Convolutional Layer)

**합성곱층**은 아래 이미지와 같이 입력 데이터의 일부분에 주목하여 그 부분에 대한 이미지의 특징을 조사하는 층입니다.

![cnn-basic-1.jpeg](cnn-basic-1.jpeg)

어떤 특징에 주목하면 좋을지에 대해서는 학습용 데이터와 손실 함수 등을 적절하게 결정하여 **자동**으로 학습합니다. 예를 들어, 얼굴 인식 CNN의 경우 적절한 학습이 진행되면 입력층에 가까운 합성곱층에서는 선과 점 등 저차원적인 개념의 특징에 주목하고, 출력층에 가까운 합성곱층에서는 눈이나 코 등 고차원적인 개념의 특징에 주목하게 됩니다. 실제로 눈이나 코 같은 고차원의 개념은 원래의 이미지에서 직접 검출되는 것이 아니라 입력층과 가까운 층에서 검색된 저차원 개념의 위치적인 조합을 바탕으로 검출됩니다.

주목할 만한 특징은 프로그램 내부에서는 **필터**(**커널**; kernel)로 불리는 **가중치 행렬**로 처리되며, 각 특징마다 하나의 필터를 사용합니다.

9x9x3(가로x세로x채널 수)의 이미지에 대해 3x3x3(가로x세로x채널 수)의 필터로 합성곱하는 모습입니다. 하나의 3x3x3의 필터를 사용하여 새로운 4x4x1의 특징 맵(feature map; 흑백사진 같은 것)을 만들고 있습니다. 또한 각각 다른 필터를 사용하여 총 N장의 4x4x1의 맵을 만듭니다. 전체적으로 이 합성곱층에서는 9x9x3 이미지가 4x4xN의 특징 맵으로 변환됩니다.

## 풀링층 (Pooling Layer)

**풀링층**은 아래 이미지와 같이 합성곱층의 출력을 축약하고 데이터양을 줄이는 층입니다.

![cnn-basic-1.jpeg](cnn-basic-1.jpeg)

아래 이미지와 같이 특징 맵의 부분 구간의 최댓값을 취하거나(Max 풀링) 또는 평균을 취하여(Average 풀링) 데이터의 압축을 실시합니다.

![cnn-basic-2.png](cnn-basic-2.png)

합성곱은 이미지 내의 특징량의 분포를 확인할 수 있습니다. 하지만 같은 특징이 유사한 위치에 뭉쳐 분포하는 경우가 많고, 특징이 없는 장소가 넓게 분포하는 경우도 있어서 합성곱층에서 출력되는 특징 맵은 데이터 낭비가 많습니다. 풀링(pooling)은 그러한 데이터 낭비를 줄이고, 정보 손실을 최소화하면서 데이터를 압축할 수 있습니다.

풀링에 의한 미세한 위치 정보는 삭제되어 버리지만 반대로 풀링층에 의해 추출된 특징이 원래 이미지의 평행이동 등에서 영향을 받지 않는 역할을 합니다. 예를 들어 사진에 비친 필기체 숫자를 분류할 경우 숫자의 위치는 중요하지 않지만 풀링을 통해 그다지 중요하지 않은 정보를 삭제하여 입력 이미지의 위치 변화에 강한 모델을 구축할 수 있습니다.

---

"50대의 추교현이 20대의 추교현에게 감사할 수 있게끔 하루하루 최선을 다해 살고자 합니다."

**_The End._**
